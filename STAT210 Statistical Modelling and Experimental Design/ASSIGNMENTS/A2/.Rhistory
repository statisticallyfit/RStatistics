geom_line(data=pred, aes(y=upr), color="dodgerblue", linetype="longdash",size=1)
p + geom_line(data=pred, aes(y=fit), color="red", size=2) +
geom_line(data=pred, aes(y=lwr), color="dodgerblue", linetype="longdash",size=1) +
geom_line(data=pred, aes(y=upr), color="dodgerblue", linetype="longdash",size=1)
p = ggplot(ratsData, aes(x=Conc, y=Skin)) +
geom_point(shape=19, size=3)
p2 = p + geom_line(data=pred, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(data=pred, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(data=pred, aes(y=upr, colour="b", linetype="b"),size=1)
p2 + scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="longdash"))
p2 + scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95% Confidence Bands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="longdash"),
labels=c("Fitted Line", "95% Confidence Bands"))
from = min(bflowData$AOT)
to = max(bflowData$AOT)
n <- nrow(bflowData)
xs <- data.frame(AOT=seq(from=from,to=to, len=n))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
pred.df
par(mfrow=c(1,1))
plot(BF ~ AOT, type="b", pch=16, xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
points(bflowData$AOT, bflowData$BF)
xy.lm
pred.df <- data.frame(SRP=c(10,20,30,40,50,60,70,80))
CI <- predict(xy.lm, interval="confidence", newdata=pred.df)
PI <- predict(xy.lm, interval="predict", newdata=pred.df)
cbind(pred.df$SRP, CI, PI)
par(mfrow=c(1,1))
plot(pred.df$SRP, CI[,1], type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction abnds")
points(dat1$ODP, dat1$SRP)
plot(CI[,1] ~ pred.df$SRP, type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction abnds")
points(dat1$ODP, dat1$SRP)
plot(CI[,1] ~ pred.df$SRP, type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction Bands")
points(dat1$ODP, dat1$SRP)
pred.df$SRP
head(pred.df)
xs <- data.frame(AOT=seq(from=from,to=to, len=n))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
par(mfrow=c(1,1))
plot(BF ~ AOT, type="b", pch=16, xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
AOT #
plot(BF ~ pred.df$AOT, type="b", pch=16, xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
from = min(bflowData$AOT)
to = max(bflowData$AOT)
xs <- data.frame(AOT=seq(from=from,to=to, by=0.01))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
length(CI)
xs$AOT
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
CI #
names(CI)
head(CI) #
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
par(mfrow=c(1,1))
plot(BF ~ pred.df$AOT, type="b", pch=16, xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
plot(pred.df$fit ~ pred.df$AOT, type="b", pch=16, xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
range(bflowData$BF)
plot(pred.df$fit ~ pred.df$AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands",
"95% Prediction Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
lines(pred.df$AOT, pred.df$CI.lower, lty=2) # lty = linetype, lty = 2 is dashed
lines(pred.df$AOT, pred.df$CI.upper, lty=2)
plot(BF ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
plot(BF ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData, type="b", pch=16,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
plot(BF ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData, pch=16,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
lines(pred.df$AOT, pred.df$fit, lty=1, size=2)
lines(pred.df$AOT, pred.df$CI.lower, lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$CI.upper, lty=2) # upper CI (97.5%)
lines(pred.df$AOT, pred.df$CI.lower, color="blue", lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$CI.lower, colour="blue", lty=2) # lower CI (2.5%)
?lines #
plot(BF ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=bflowData, pch=16,
main="Bflow ~ AOT, with predicted values and 95% confidence bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
lines(pred.df$AOT, pred.df$fit, lty=1)
lines(pred.df$AOT, pred.df$CI.lower, colour="blue", lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$CI.upper, colour="blue", lty=2) # upper CI (97.5%)
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands",
"95% Prediction Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
points(AOT, BF, data=ratsData)
plot(pred.df$fit ~ pred.df$AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=16,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=16,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
xs <- data.frame(AOT=seq(from=from,to=to, by=0.05))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=16,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
xs <- data.frame(AOT=seq(from=from,to=to, by=0.1))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=16,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
xs <- data.frame(AOT=seq(from=from,to=to, by=0.5))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
points(AOT, BF, data=ratsData)
with(ratsData, points(AOT, BF))
points(ratsData$AOT, ratsData$BF)
xy.lm
points(ratsData$BF, ratsData$AOT)
points(ratsData$BF, ratsData$AOT)
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
points(ratsData$BF, ratsData$AOT)
points(ratsData$BF, ratsData$AOT , pch=1)
points(y=ratsData$BF, x=ratsData$AOT )
par(mfrow=c(1,1))
plot(pred.df$SRP, CI[,1], type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction abnds")
points(dat1$ODP, dat1$SRP)
pred.df <- data.frame(SRP=c(10,20,30,40,50,60,70,80))
CI <- predict(xy.lm, interval="confidence", newdata=pred.df)
PI <- predict(xy.lm, interval="predict", newdata=pred.df)
cbind(pred.df$SRP, CI, PI)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(pred.df$SRP, CI[,1], type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction abnds")
points(dat1$ODP, dat1$SRP)
par(mfrow=c(1,1))
plot(pred.df$SRP, CI[,1], type="b", pch=16, xlab="SRP", ylab="mean ODP",
main="Scatterplot of ODP ~ SRP, with predicted values and 95%
confidence and prediction abnds")
points(dat1$ODP, dat1$SRP)
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
# the levels are by default 95% for the CIs
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, CI.lower=CI$lwr, CI.upper=CI$upr)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$CI.lower), max(pred.df$CI.upper)))
points(y=bflowData$BF, x=bflowData$AOT )
lines(pred.df$AOT, pred.df$fit, lty=1)
lines(pred.df$AOT, pred.df$CI.lower, lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$CI.upper, lty=2) # upper CI (97.5%)
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
p.data = ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3)
head(pred.df)
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, lwr=CI$lwr, upr=CI$upr)
p.data = ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3)
p2 = p.data + geom_line(pred.df, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(pred.df, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(pred.df, aes(y=upr, colour="b", linetype="b"),size=1)
pred.df
setwd("/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/ASSIGNMENTS/A2/")
source('/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/Rfunctions.R')
library(ggplot2)
options(digits=10, show.signif.stars = F)
# part a)
bflowData <- read.table("bloodflow.txt", header=TRUE)
# Scatterplot suggests there are 3 peaks and troughs
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3) +
ggtitle("Scatterplot of Arterial Oxygen Tension (AOT) against Bloodflow (BF)")
# Polynomial order = peaks/troughs - 1. Here is looks like peaks/troughs = 3
# so at most 3+1= 4th order could be fitted, perhaps.
# There is definite curvature so at least a quadratic model could be fitted.
# part b)
# see: linear is definitely not appropriate: anova term for AOT
# means model with AOT is not significant. That is the p-value of the
# global F-test.
bflow.1.lm <- lm(BF ~ AOT, data=bflowData)
anova(bflow.1.lm)
summary(bflow.1.lm)
bflow.2.lm <- lm(BF ~ AOT + I(AOT^2), data=bflowData)
anova(bflow.2.lm) # quadratic model is significant, given linear
# model has been fitted, so continue
bflow.3.lm <- update(bflow.2.lm, .~. + I(AOT^3), data=bflowData)
anova(bflow.3.lm) # cubic isn't significant so just use quadratic.
from = min(bflowData$AOT)
to = max(bflowData$AOT)
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
# the levels are by default 95% for the CIs
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, lwr=CI$lwr, upr=CI$upr)
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$lwr), max(pred.df$upr)))
points(y=bflowData$BF, x=bflowData$AOT )
lines(pred.df$AOT, pred.df$fit, lty=1)
lines(pred.df$AOT, pred.df$lwr, lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$upr, lty=2) # upper CI (97.5%)
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
p.data = ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3)
p.data
p.fits = p.data + geom_line(pred.df, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(pred.df, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(pred.df, aes(y=upr, colour="b", linetype="b"),size=1)
names(pred.df)
p.fits + scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
pred
xs <- data.frame(Conc=seq(0.5, 3, 0.05))
head(xs)
# the se.fit is the stderrors of the fitted values for each fitted value
# in the sequence 0.5 to 3 by 0.05 intervals (to be more fine-grained for plotting)
#pred <- predict(skin4.lm, newdata=xs, se.fit=TRUE, interval="confidence")
pred <- data.frame(predict(skin4.lm, newdata=xs, interval="confidence"))
pred$Conc <- xs$Conc
skin4.lm <- lm(Skin ~ Conc + I(Conc^2) + I(Conc^3) + I(Conc^4), data=ratsData)
conc <- c(rep(seq(from = 0.5, to = 3, by = 0.5), 2))
conc #
# ys = skin response in rats
skin <- c(13.9, 14.08, 13.75, 13.32, 13.45, 13.59, 13.81, 13.99, 13.60, 13.39,
13.53, 13.64)
ratsData <- data.frame(Skin=skin, Conc=conc)
skin4.lm <- lm(Skin ~ Conc + I(Conc^2) + I(Conc^3) + I(Conc^4), data=ratsData)
xs <- data.frame(Conc=seq(0.5, 3, 0.05))
pred <- data.frame(predict(skin4.lm, newdata=xs, interval="confidence"))
pred$Conc <- xs$Conc
plot(Skin ~ Conc, ylim = c(min(pred$lwr), max(pred$upr)), data=ratsData)
# add fitted line to plot
lines(xs$Conc, pred$fit, lty=1)
lines(xs$Conc, pred$lwr, lty=2)
lines(xs$Conc, pred$upr, lty=2)
legend(x=2,y=14.2, legend=c("Fitted Curve", "95% Confidence Bands"), lty=1:2)
p = ggplot(ratsData, aes(x=Conc, y=Skin)) +
geom_point(shape=19, size=3)
p2 = p + geom_line(data=pred, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(data=pred, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(data=pred, aes(y=upr, colour="b", linetype="b"),size=1)
p2 + scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
pred
from = min(bflowData$AOT)
to = max(bflowData$AOT)
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
# the levels are by default 95% for the CIs
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, lwr=CI$lwr, upr=CI$upr)
p.data = ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3)
p.fits = p.data + geom_line(pred.df, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(pred.df, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(pred.df, aes(y=upr, colour="b", linetype="b"),size=1)
p.fits = p.data +
geom_line(data=pred.df, aes(y=fit, colour="a", linetype="a"),size=1) +
geom_line(data=pred.df, aes(y=lwr, colour="b", linetype="b"),size=1) +
geom_line(data=pred.df, aes(y=upr, colour="b", linetype="b"),size=1)
p.fits + scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
p.legend <- p.fits +
scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
p.plot <- p.fits +
ggtitle("Predicted and Observed Values of BF vs AOT and 95% Confidence Bands")
scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
p.plot <- p.fits +
ggtitle("Predicted and Observed Values of BF vs AOT
and 95% Confidence Bands") +
scale_colour_manual(name="Legend", values=c("a"="red", "b"="dodgerblue"),
labels=c("Fitted Line", "95%\nConfidence\nBands")) +
scale_linetype_manual(name="Legend", values=c("a"="solid", "b"="dashed"),
labels=c("Fitted Line", "95%\nConfidence\nBands"))
p.plot #
plot(bflow.2.lm)
par(mfrow=c(2,2))
plot(bflow.2.lm)
setwd("/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/ASSIGNMENTS/A2/")
source('/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/Rfunctions.R')
options(digits=10, show.signif.stars = F)
bflowData <- read.table("bloodflow.txt", header=TRUE)
setwd("/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/ASSIGNMENTS/A2/")
source('/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/Rfunctions.R')
options(digits=10, show.signif.stars = F)
# part a)
bflowData <- read.table("bloodflow.txt", header=TRUE)
library(ggplot2)
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=) +
ggtitle("Scatterplot of Arterial Oxygen Tension (AOT) \n\t\tagainst Bloodflow (BF)")
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=) +
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3) +
ggtitle("Arterial Oxygen Tension vs. Bloodflow")
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3) +
ggtitle("Arterial Oxygen Tension vs. Bloodflow")
bflow.1.lm <- lm(BF ~ AOT, data=bflowData)
anova(bflow.1.lm)
summary(bflow.1.lm)
bflow.2.lm <- lm(BF ~ AOT + I(AOT^2), data=bflowData)
anova(bflow.2.lm) # quadratic model is significant, given linear
bflow.3.lm <- update(bflow.2.lm, .~. + I(AOT^3), data=bflowData)
anova(bflow.3.lm) # cubic isn't significant so just use quadratic.
from = min(bflowData$AOT)
to = max(bflowData$AOT)
source('/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/PLOTTING.R', echo=TRUE)
partialPlot(bflow.2.lm, variableName = "AOT")
partialPlot(bflow.1.lm, variableName = "AOT")
partialPlot(bflow.4.lm, variableName = "AOT")
bflow.4.lm <- lm(BF ~ AOT + I(AOT^2) + I(AOT^3) + I(AOT^4), data=bflowData)
partialPlot(bflow.4.lm, variableName = "AOT")
bflow5.lm <- update(bflow.4.lm,.~. + I(AOT^5), data=bflowData)
partialPlot(bflow5.lm, variableName = "AOT")
from = min(bflowData$AOT)
to = max(bflowData$AOT)
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
library(ggfortify)
autoplot(bflow.1.lm, which=1:2)
autoplot(bflow.1.lm, which=1:2, size=3, color="navy")
autoplot(bflow.1.lm, which=1:2)
shapiro.test(bflow.1.lm$residuals)
bflow.2.lm <- lm(BF ~ AOT + I(AOT^2), data=bflowData)
anova(bflow.2.lm) # quadratic model is significant, given linear
autoplot(bflow.2.lm, which=1:2)
autoplot(bflow.1.lm, which=c(1,3))
plot(bflow.1.lm, which=1)
par(mfrow=c(1,1))
plot(bflow.1.lm, which=1)
plot(bflow.1.lm, which=1, add.smooth = F)
plot(bflow.2.lm, which=1:4, add.smooth = FALSE)
par(mfrow=c(2,2))
plot(bflow.2.lm, add.smooth = FALSE)
plot(bflow.2.lm, which=1:5, add.smooth = FALSE)
plot(bflow.2.lm, which=1:8, add.smooth = FALSE)
plot(bflow.2.lm, which=1:6, add.smooth = FALSE)
plot(bflow.1.lm, which=c(1,3), add.smooth = FALSE)
par(mfrow=c(2,1))
plot(bflow.1.lm, which=c(1,3), add.smooth = FALSE)
par(mfrow=c(1,2))
plot(bflow.1.lm, which=c(1,3), add.smooth = FALSE)
plot(bflow.1.lm, which=c(1,1), add.smooth = FALSE)
plot(bflow.1.lm, which=c(1,1), add.smooth = FALSE)
plot(bflow.1.lm, which=c(1,2), add.smooth = FALSE)
bflow.3.lm <- update(bflow.2.lm, .~. + I(AOT^3), data=bflowData)
anova(bflow.3.lm) # cubic isn't significant so just use quadratic.
par(mfrow=c(2,2))
plot(bflow.2.lm)
shapiro.test(bflow.2.lm$residuals)
par(mfrow=c(3,2))
plot(bflow.2.lm)
plot(bflow.2.lm, which=1:6)
par(mfrow=c(3,2))
plot(bflow.2.lm, which=1:6)
plot(bflow.2.lm, which=1:4)
par(mfrow=c(2,2))
plot(bflow.2.lm, which=1:4)
plot(bflow.2.lm, which=1:4, add.smooth=FALSE)
par(mfrow=c(1,2))
plot(bflow.2.lm, which=5:6)
source('/datascience/projects/statisticallyfit/github/R/RStatistics/STAT210 Statistical Modelling and Experimental Design/FORMULAS.R', echo=TRUE)
cooksDistance(bflow.2.lm)
influentialPoints(bflow.2.lm)
ggplot(bflowData, aes(x=AOT, y=BF)) +
geom_point(shape=19, size=3) +
ggtitle("Arterial Oxygen Tension vs. Bloodflow")
bflow.1.lm <- lm(BF ~ AOT, data=bflowData)
anova(bflow.1.lm)
par(mfrow=c(1,2))
plot(bflow.1.lm, which=c(1,2), add.smooth = FALSE)
autoplot(bflow.1.lm, smooth=F)
autoplot(bflow.1.lm, smooth.colour="none")
autoplot(bflow.1.lm, smooth.colour="gray")
plot(bflow.1.lm, which=c(1,2), add.smooth = FALSE)
bflow.2.lm <- lm(BF ~ AOT + I(AOT^2), data=bflowData)
anova(bflow.2.lm) # quadratic model is significant, given linear
bflow.3.lm <- update(bflow.2.lm, .~. + I(AOT^3), data=bflowData)
anova(bflow.3.lm) # cubic isn't significant so just use quadratic.
shapiro.test(bflow.2.lm$residuals) # no deviation from normality.
summary(bflow.2.lm)
shapiro.test(bflow.2.lm$residuals) # no deviation from normality.
summary(bflow.2.lm)
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$lwr), max(pred.df$upr)))
points(y=bflowData$BF, x=bflowData$AOT )
lines(pred.df$AOT, pred.df$fit, lty=1)
lines(pred.df$AOT, pred.df$lwr, lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$upr, lty=2) # upper CI (97.5%)
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
from = min(bflowData$AOT)
to = max(bflowData$AOT)
xs <- data.frame(AOT=seq(from=from,to=to, len=nrow(bflowData)))
# the levels are by default 95% for the CIs
CI <- data.frame(predict(bflow.2.lm, interval="confidence", newdata=xs))
# placing also the AOT generated values here for plotting purposes.
pred.df <- data.frame(AOT=xs$AOT, fit=CI$fit, lwr=CI$lwr, upr=CI$upr)
# Plotting confidence bands
par(mfrow=c(1,1))
plot(fit ~ AOT,  xlab="Arterial Oxygen Tension", ylab="Bloodflow",
data=pred.df, pch=20,
main="Predicted and Observed Values of BF vs AOT and 95% Confidence Bands",
ylim = c(min(pred.df$lwr), max(pred.df$upr)))
points(y=bflowData$BF, x=bflowData$AOT )
lines(pred.df$AOT, pred.df$fit, lty=1)
lines(pred.df$AOT, pred.df$lwr, lty=2) # lower CI (2.5%)
lines(pred.df$AOT, pred.df$upr, lty=2) # upper CI (97.5%)
legend(360,84, lty=c(1, 2, 3), legend=c("Line of best fit",
"95% Confidence Bands"))
legend(400, 82, pch=c(1,16), legend=c("observed values", "predicted values"))
par(mfrow=c(2,2))
plot(bflow.2.lm, add.smooth=FALSE)
